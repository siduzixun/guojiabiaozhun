# 声明 
本文是学习[网络安全应急响应典型案例集（2021）. ](https://siduwenku.com/view/55061?f=new_2023)而整理的学习笔记,分享出来希望更多人受益,如果存在侵权请及时联系我们
# 蠕虫类事件典型案例  
  
蠕虫病毒也是一种常见的计算机病毒，具有较强独立性，可以不依赖宿主程序独立运行，具有传播更快更广以及更好的伪装和隐藏的特点，通常利用恶意链接、电子邮件附件、U盘携带以及弱密码暴破的方式发起攻击，受害者一旦点击包含有被蠕虫感染的链接和邮件附件，蠕虫病毒会立刻被激活，并迅速感染其他主机，窃取重要信息，严重时会导致网络系统瘫痪，服务器系统资源遭到破坏。  
  
## 服务器弱口令导致感染蠕虫病毒  
  
### 事件概述  
  
2016年，奇安信集团安服团队接到某银行应急响应请求，其发现内网有服务器出现工作异常，并发现网络中存在扫描行为，应急响应专家1小时内到达现场。  
  
应急响应专家通过现场进行检测分析，发现大量来自A省分行的服务器可疑远程桌面暴破行为，进一步远程检测发现A省分行服务器上均存在恶意进程，正在批量扫描暴破内网3389端口，其中B省某重要业务系统已被暴破成功，并对全国至少19家分行进行扫描。通过对样本进行分析，确认该银行内网中感染了Morto家族系的蠕虫的最新进化版本，主要实现远控目的。对A省被攻陷终端的日志分析，攻击者早在2015年就已进入到A省分行内部网络区域，对整个银行内部网络的暴破攻击长达1年以上。  
  
此外，不同省分行主机均存在以下问题：  
  
1、用户名均为User ，密码为 111111；  
  
2、均开启远程桌面服务，同时对其他开启远程桌面服务的资产产生大量连接（暴破行为）；  
  
3、开始－运行中存在 rundll32 \\\\tsclient\\a\\a.dll a 的命令执行记录；  
  
4、服务均存在名为 FastUserSwitchingCompatibility以及 Ias 的异常服务。  
  
### 防护建议  
  
1.  所有服务器、终端应强行实施复杂密码策略，杜绝弱口令；  
1.  对服务器进行安全加固，关闭远程桌面功能、定期更换密码、禁止使用最高权限用户运行程序、使用HTTPS加密协议等；  
2.  建立安全灾备预案，一旦核心系统遭受攻击，需要确保备份业务系统可以立即启用；  
3.  对服务器定期维护，内容包括但不限于：查看服务器操作系统是否存在可疑进程、计划任务中是否存在可疑项等；  
4.  在服务器上部署安全加固软件，通过限制异常登录行为、开启防暴破功能、禁用或限用危险端口、防范漏洞利用等方式，提高系统安全基线，防范黑客入侵；  
5.  安装杀毒软件、终端安全管理软件并及时更新病毒库。  
  
## 浏览恶意链接感染蠕虫病毒  
  
### 事件概述  
  
2018年11月，奇安信集团安服团队接到某部委蠕虫病毒事件应急响应请求，其发现内网多台终端外连恶意域名并下载恶意软件。  
  
应急人员到达现场后，对内网服务器文件、服务器账号、网络连接、日志等多方面进行分析，发现内网主机用户浏览带有恶意链接的Web页面，并于内嵌链接中触发对该异常域名的访问，导致服务器被感染飞客蠕虫病毒，并外连下载恶意软件。该病毒会对随机生成的IP地址发起攻击，攻击成功后会下载一个木马病毒，通过修改注册表键值来使某免费安全工具功能失效。病毒会修改hosts文件，使用户无法正常访问安全厂商网站及服务器。  
  
### 防护建议  
  
1.  配置并开启操作系统、关键应用等自动更新功能，对最新系统、应用安全补丁进行订阅、更新。避免攻击者通过相关系统、应用安全漏洞对系统实施攻击，或在获取系统访问权限后，对系统用户权限进行提升；  
1.  限制服务器及其他业务服务网可进行访问的网络、主机范围。有效加强访问控制ACL策略，细化策略粒度，按区域按业务严格限制各个网络区域以及服务器之间的访问，采用白名单机制只允许开放特定的业务必要端口，其他端口一律禁止访问，仅管理员IP可对管理端口进行访问，如FTP、数据库服务、远程桌面等管理端口，限制公网主机对139、445端口等访问；  
2.  部署高级威胁监测设备，及时发现恶意网络流量，同时可进一步加强追踪溯源能力，对安全事件发生时可提供可靠的追溯依据；  
3.  定期开展对系统、应用以及网络层面的安全评估、渗透测试以及代码审计工作，主动发现目前系统、应用存在的安全隐患；  
4.  加强日常安全巡检制度，定期对系统配置、网络设备配合、安全日志以及安全策略落实情况进行检查，常态化信息安全工作；  
5.  服务器上部署安全加固软件，通过限制异常登录行为、开启防暴破功能、禁用或限用危险端口、防范漏洞利用等方式，提高系统安全基线，防范黑客入侵；  
6.  加强人员安全意识培养，不要点击来源不明的邮件附件，不从不明网站下载软件。对来源不明的文件包括邮件附件、上传文件等要先杀毒处理。  
  
## U盘未合理管控导致感染蠕虫病毒  
  
### 事件概述  
  
2019年1月，某工业集团为了便于各测试系统中测试数据的统一采集、存储和管理，各测试系统将陆续接入TDM系统（测试数据管理系统），当前仍然有部分测试设备、系统未接入。由于移动介质的交叉使用、相关使用规范的缺失，当前未入网的设备/系统中存在大量病毒，因此该工业集团请求工业安全应急响应中心进行应急响应。  
  
工业安全应急响应中心人员到达现场后，经对现场情况的了解及设备的检测，发现当前设备、系统、网络中存在的主要问题是由于U盘的不合理使用使得TDM系统中感染了“Conficker” 蠕虫、矢网仪感染了“FakeFolder”蠕虫病毒。  
  
病毒可通过移动介质、网络大范围传播，由此形成恶性循环；同时，病毒感染后可进行各种恶意操作，如安装后门、窃取敏感数据、篡改数据等，数据可通过被感染的移动介质和主机传播外泄，由此造成敏感数据丢失、测试数据不准确，最终导致产品出现功能、性能问题的可能性；缺乏对U盘使用的基本管理制度，亦无技术管控措施；安全意识有待提高，安全制度建立有待完善。  
  
### 防护建议  
  
1.  在工业终端、服务器等安装工业主机安全防护系统，建立安全基线，对U盘使用进行策略配置；  
1.  对于TDM系统，可在控制主机和数据中转主机之间配置工业网关设备，保证数据的安全、单向传输，在TDM网络边界处部署工业防火墙。除此之外，做好应急准备，将安全处置风险降到最低或可控。  
  
# 篡改类事件典型案例  
  
篡改类事件主要包括网页篡改，网站黑链、网站挂马等类型，攻击者通常利用漏洞利用、木马病毒程序等方式对网页内容进行篡改，植入违法信息、暗链、挂黑页等，借以达到炫耀自己的技术能力、非法获利、刻意抹黑等目的。  
  
## Redis未授权访问漏洞致官网被植入黑链  
  
### 事件概述  
  
2017年，奇安信安服团队接到某出版社应急响应请求，官网出现黑链急需溯源排查，应急响应专家30分钟到达现场。  
  
应急人员抵达现场后，通过对系统分析发现在WEB负载服务器WEB01中确实存在黑链，对Web01进行排查发现后门文件，溯源分析后发现攻击者是通过TRS服务器登入Web01系统，获取了Web01系统权限，通过对TRS服务器Web日志分析发现攻击者利用TRS漏洞，植入WebShell后门，攻击IP经调研后发现为内部Redis服务器，通过对Redis服务器进行分析发现该机器存在RootKit程序，该程序会自动连接到攻击者服务器，植入时间为：2017/03/17 ，且在该机器上发现了攻击者利用Redis未授权获得本机SSH管理权限的行为和内网扫描行为。  
  
综上，攻击者通过利用Redis未授权漏洞获取了Redis服务器本机SSH管理权限，并对同网段进行扫描，发现TRS服务器存在漏洞，并对该漏洞进行利用，获取TRS服务器权限并植入Webshell后门文件，由于TRS服务器与WEB负载服务器均使用相同密码，攻击者通过密码登录到WEB负载服务器，植入后门文件，并在官网首页文件中插入恶意代码。  
  
### 防护建议  
  
1.  系统、应用相关的用户杜绝使用弱口令，同时，应该使用高复杂强度的密码，尽量包含大小写字母、数字、特殊符号等的混合密码，加强管理员安全意识，禁止密码重用的情况出现；  
1.  禁止外部访问Redis服务端口，禁止使用root权限启动redis服务，配置安全组，限制可连接Redis服务器的IP；  
2.  安装webshell检测工具，根据检测结果对已发现的可以webshell痕迹立即隔离查杀，并排查漏洞；  
3.  加强权限管理，对敏感目录进行权限设置，限制上传目录的脚本执行权限，不允许配置执行权限等；  
4.  日常要多维护，并注意服务器中是否有来历不明的可执行脚本文件；  
5.  TRS服务升级为最新版本。  
  
## 网站WEB漏洞致网站被挂马  
  
### 事件概述  
  
2018年5月，奇安信集团安服团队接到某集团网站挂马事件应急响应请求，其门户网站被挂马，非域名或IP直接访问跳转色情网站。  
  
应急人员到达现场后，对网站系统、服务器文件、账号、网络连接、日志等多方面进行分析，网站网页被植入恶意JS脚本代码，同时网站系统存在DOTNETCMS 1.0 版本漏洞。  
  
经过分析排查，本次事件中黑客主要通过对网站进行扫描，发现网站系统存在SQL注入、登录绕过、任意文件上传等漏洞，黑客通过利用漏洞获取系统权限，并在网页中加入恶意JS脚本，并为了不被内部管理维护人员发现，以达到更长时间的黑帽SEO流量，黑客限制只从百度等搜索引擎跳转，其他则不跳转。  
  
### 防护建议  
  
1.  平时运维过程中应当及时备份重要文件，且文件备份应与主机隔离，规避通过共享磁盘等方式进行备份；  
1.  尽量避免打开来源不明的链接，给信任网站添加书签并通过书签访问；  
2.  对非可信来源的邮件保持警惕，避免打开附件或点击邮件中的链接；  
3.  定期用专业反病毒软件扫描系统.及时对服务器的补丁进行更新；  
4.  定期开展对系统、应用以及网络层面的安全评估、渗透测试以及代码审计工作，主动发现目前系统、应用存在的安全隐患；  
5.  加强日常安全巡检制度，定期对系统配置、网络设备配合、安全日志以及安全策略落实情况进行检查，常态化信息安全工作。  
  
## 网站后台程序漏洞致网站被植入黑链  
  
### 事件概述  
  
2018年5月，奇安信集团安服团队接到某大学信息中心的网站安全应急响应请求，其官网上出现大量黑链、赌博、游戏外挂等违规关键词。  
  
应急响应人员到达现场后，对网站服务器文件、服务器账号、网络连接、进程信息、服务信息、日志信息等多方面进行分析，发现文件中包含大量aspx木马及gif图片伪装成木马，发现存在多个无效账号，以及向外连接的可疑IP地址。  
  
经过分析排查发现，本次事件中所使用的黑链手法为黑产行业惯用手法，利用搜索引擎对大学院校网站发表内容收录快、排名高等优势，利用网站后台程序漏洞对网站进行攻击，上传webshell木马文件至服务器，获取网站管理权限并篡改服务器原有文件，插入黑链恶意脚本，达到控制搜索引擎网页访问跳转，实现搜索引擎“黑帽SEO”。在获取权限后克隆服务器管理员账号以达到长期控制服务器的目的。  
  
### 防护建议  
  
1.  建议部署操作系统及相关应用并生成快照，进一步落实口令管理；  
1.  建议使用独立的、随机生成的满足强度要求的口令，严禁使用弱口令、统一口令管理服务器，及时销毁临时、测试账户；  
2.  修改后台管理员密码为复杂密码，修改后台管理目录为复杂路径防止被攻击者猜到，禁用或删除后台模板功能；  
3.  服务器运行环境部署需要进行加固处理，关注各个应用系统所使用程序、组件、第三方插件等安全现状，及时更新相应的补丁版本；  
4.  加强对敏感服务器、配置文件、目录的访问控制，以免敏感配置信息泄露；加强信息系统安全配置检查工作。  
  
## Tomcat中间件漏洞致官网被上传博彩页面  
  
### 事件概述  
  
2018年5月，奇安信安服团队接到某政府部门应急响应请求，客户官网被植入博彩页面，希望协助恢复官网正常业务，并追溯攻击来源。  
  
应急人员抵达现场后，分别对WCM后台编辑管理平台、iGuard网页防篡改系统、Linux WEB前端服务器进行排查，成功定位博彩页面及Webshell文件。在运维人员对服务器镜像进行备份后，将博彩页面、Webshell文件进行删除，网站恢复正常工作。  
  
应急人员经过分析排查，成功还原攻击路径：攻击者利用WCM系统的Tomcat中间件漏洞上传Webshell文件，获得了WCM系统管理员权限，继而将博彩页面上传至WCM服务器。之后，WCM服务器上的博彩页面被iGuard推送至iGurad服务器和前端WEB服务器，造成了“网站被挂博彩页面暗链”的情况。此外，攻击者还留下了其它的webshell以便对WCM服务器实现长期控制。  
  
### 防护建议  
  
1.  及时进行中间件版本更新，对已知漏洞进行补丁修复；  
1.  安装服务器防护软件，及时更新病毒库，对发现的威胁文件立即隔离查杀，并排查漏洞；  
2.  建议部署网页防篡改设备，对网站文件、目录进行保护，拦截黑客的篡改操作，实时监控受保护的文件和目录，发现文件被篡改时，立即获取备份文件并进行还原；  
3.  对服务器开展安全大检查，包括但不限于恶意IP封禁、恶意文件以及后门清理、网站漏洞检测及修复等。  
  
## Weblogic WLS组件漏洞致网页被篡改  
  
### 事件概述  
  
2020年6月，安服应急响应团队接到某事业单位应急响应请求，其官网首页被篡改挂有违法图片，希望对该官网系统业务服务器进行排查分析，并追溯攻击来源。  
  
应急人员抵达现场后，与现场运维人员沟通了解到，业务服务器通过99端口对互联网提供WEB应用服务。  
  
应急人员通过对该服务器Web日志进行排查分析发现，该服务器对互联网还开放9001和9002端口，并发现攻击者在凌晨6点上传一句话木马s.jsp文件。应急人员通过关联s.jsp文件名，检索access.log 和 WLS_REPORTS.log 日志最终确定攻击者ip，并筛出该攻击ip所有访问日志。通过对访问日志进行排查分析发现，该日志中有大量针对9002端口的Weblogic WLS 组件漏洞攻击的痕迹，由于无法通过Web应用日志确认是否存在Weblogic WLS组件漏洞，因此，应急人员利用Weblogic WLS组件漏洞进行攻击测试，最终确认存在该漏洞。根据日志中攻击者利用Weblogic WLS 组件漏洞攻击时间与官网首页篡改时间比对，攻击成功时间和官网首页被篡改时间相近，由此推断攻击者利用Weblogic WLS 组件漏洞代码进行攻击，成功进入服务器。  
  
攻击者利用Weblogic反序列化漏洞，对开放9002端口的服务器进行攻击，获得该服务器权限并上传一句话木马s.jsp文件。通过查看服务器web目录发现，该服务器对外开放的99端口下部署有该公司官网系统，随后向该系统上传违法图片，修改官网首页。  
  
### 防护建议  
  
1.  对系统文件上传功能，采用白名单上传文件，不在白名单内的一律禁止上传，上传目录权限遵循最小权限原则；  
1.  加强权限管理，对敏感目录进行权限设置，限制上传目录的脚本执行权限，不允许配置执行权限等；  
2.  关注官方漏洞发布信息，及时安装漏洞补丁，加强日常安全巡检工作，定期对系统配置、网络设备配置、安全日志以及安全策略落实情况进行检查，常态化信息安全工作；  
3.  关闭不必要的高危端口，对服务器开展安全大检查，包括但不限于恶意IP封禁、恶意文件以及后门清理、网站漏洞检测及修复等；  
4.  建议部署网页防篡改设备，对网站文件、目录进行保护，拦截黑客的篡改操作，实时监控受保护的文件和目录，发现文件被篡改时，立即获取备份的合法文件并进行文件还原。  
  
## weblogic反序列化漏洞致网页被篡改  
  
### 事件概述  
  
2020年9月，奇安信安服团队接到某政府部门应急请求，其网站首页被篡改挂有违法标语，需要进行排查分析并溯源。  
  
奇安信安服应急人员到达现场后通过了解现场网络架构及应用部署情况，分别对应用web应用文件排查、系统日志分析以及防火墙日志分析排查发现web应用服务网站http://11.xx.xx.1与http://11.xx.xx.2 网站首页被篡改、网站存在weblogic反序列化漏洞、服务器存在恶意文件及图片。  
  
经过最终研判分析，黑客首先通过IP:198.xx.xx.21对网站应用平台进行扫描攻击，通过扫描发现网站http://11.xx.xx.1与http://11.xx.xx.2存在weblogic反序列化漏洞。攻击者通过利用该漏洞默认路径下可提交恶意的XML格式的数据，提交的数据在服务器端反序列化时实现远程命令执行，进而获得服务器的权限。最后通过获取到的服务器权限来修改网站首页文件index.jsp，加载恶意图片1.jpg，成功篡改网站首页，并在违法黑客网站进行炫耀其攻击成果。  
  
### 防护建议  
  
1.  封禁攻击者服务器IP、删除服务器上恶意文件及图片；  
1.  对应用平台漏洞进行补丁修复，修复相关组件进行重启；  
2.  加强安全运营监控力度，针对告警事件分析研判与处置；  
3.  优化主机、网络安全设备安全策略；  
4.  如非必须禁止内网服务器出外网；  
5.  有效加强访问控制ACL策略，采用白名单机制只允许开放特定的业务必要端口，其他端口一律禁止访问，仅管理员IP可对管理端口进行访问，如FTP、数据库服务、远程桌面等管理端口。  
  
## 官网存在SQL注入漏洞致网页被篡改  
  
### 事件概述  
  
2020年11月安服应急响应团队接到某教育机构应急响应求助，教育机构官网遭到恶意篡改，部分页面自动跳转至违法网站，希望进行分析排查溯源。  
  
应急响应人员抵达现场后，通过了解现场网络架构及应用部署情况，对受害页面以及Web应用文件进行排查，发现网站目录中存在已被利用的Webshell文件，创建时间为事发前一晚23点，应急人员通过测试，发现网站后台图片上传处存在任意文件上传漏洞。通过提取网站Web应用日志进行分析，发现在事发前一天下午3点，有境外IP（x.x.x.119）对网站A发起SQL注入攻击，并成功获取到了网站后台管理员账号及密码。  
  
经过一系列排查分析，应急人员成功溯源攻击途径，攻击者（x.x.x.119）在事发前一天下午3点发现网站A存在SQL注入漏洞，并对其进行利用，成功获取网站后台管理员账号及密码。事发前一晚23点，攻击者假冒管理员身份登录后台，发现后台页面存在任意文件上传漏洞，利用该漏洞成功上传Webshell文件。事发当天，攻击者利用已上传的Webshell对网站源代码进行修改，将网站部分页面跳转至违法页面。  
  
### 防护建议  
  
1.  建议部署网页防篡改设备，对网站文件、目录进行保护，拦截黑客的篡改操作，实时监控受保护的文件和目录，发现文件被篡改时，立即获取备份的合法文件并进行文件还原；  
1.  对服务器开展安全大检查，包括但不限于恶意IP封禁、恶意文件以及后门清理、网站漏洞检测及修复等；  
2.  加强日常安全巡检工作，定期对系统配置、网络设备配置、安全日志以及安全策略落实情况进行检查，定期安装补丁、更新病毒库，常态化信息安全工作；  
3.  建议在服务器上部署安全加固软件，通过限制异常登录行为、开启防暴破功能、禁用或限用危险端口、防范漏洞利用等方式，提高系统安全基线，防范黑客入侵；  
4.  部署高级威胁监测设备，及时发现恶意网络流量，同时可进一步加强追踪溯源能力，对安全事件发生时可提供可靠的追溯依据。  
  
## 编辑器漏洞致网站被挂黑页  
  
### 事件概述  
  
2021年4月，奇安信安服团队接到某政府部门的应急响应求助，其官网被上传黑页，需要进行排查分析并溯源。  
  
应急人员抵达现场后，对网站web目录进行排查，成功定位黑页位置，同时发现网站备份文件www.zip，并在备份文件中发现版本为v4.1.3的kindeditor编辑器。对web日志进行分析发现，该日志中存在某公网IP（x.x.x.62）对失陷网站上传黑页文件、压缩文件63.zip的记录，以及对www.zip文件的扫描记录。应急人员对63.zip进行分析发现，该压缩文件中包含webshell文件，但无法解析成功。  
  
应急人员协助删除黑页，恢复网站正常运行，并最终确认，攻击者首先对网站进行扫描，发现网站备份文件www.zip并进行分析，获取了网站目录结构和配置信息，同时在备份文件中发现版本为V4.1.3的kindeditor编辑器，攻击者利用该版本编辑器存在的文件上传漏洞，上传了包含webshell的压缩文件63.zip，但未能解析成功，继而上传黑页文件，对网站进行了恶意篡改。为了进一步获取网站权限，攻击者还对该网站进行SQL注入、敏感路径扫描、XSS攻击等操作，但均未成功。  
  
![siduwenku.com 专注免费分享高质量文档](http://public.host.github5.com/media/6674f25df85db97d02cba1e9c93cefad.png)  
  
图2-5：攻击路径图  
  
### 防护建议  
  
1.  升级kindeditor编辑器到最新版本，或者在不影响业务的情况下关闭相关文件上传功能；  
1.  建议部署网页防篡改设备，对网站文件、目录进行保护，拦截黑客的篡改操作，实时监控受保护的文件和目录，发现文件被篡改时，立即获取备份的合法文件并进行文件还原；  
2.  对网站根目录文件上传功能，采用白名单上传文件，不在白名单内的一律禁止上传，上传目录权限遵循最小权限原则；  
3.  加强日常安全巡检工作，定期对系统配置、网络设备配置、安全日志以及安全策略落实情况进行检查，定期安装补丁、更新病毒库，常态化信息安全工作；  
4.  部署高级威胁监测设备，及时发现恶意网络流量，同时可进一步加强追踪溯源能力，安全事件发生时可提供可靠的追溯依据。  
  

# 延伸阅读 
 更多内容 可以[ 网络安全应急响应典型案例集（2021）. ](https://siduwenku.com/view/55061?f=2023)进一步学习

# 友情连接
[DB32-T 3808-2020 台湾含笑扦插育苗技术规程 江苏省.pdf](http://github5.com/view/26238?f=new)

[T-ZZB 2404—2021 N,N-二异丙基碳二亚胺.pdf](http://github5.com/view/62824?f=new)

[DB14-T 2321-2021 公路工程野外勘察作业人员安全防护指南 山西省.pdf](http://github5.com/view/23349?f=new)
